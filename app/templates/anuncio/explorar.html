{% extends 'base.html' %}
{% block content %}
<h1>Explorar Anúncios</h1>
<form method="get" style="margin-bottom: 20px;">
    <label for="categoria">Filtrar por categoria:</label>
    <select name="categoria" id="categoria" onchange="this.form.submit()">
        <option value="">Todas</option>
        {% for categoria in categorias %}
            <option value="{{ categoria.id }}" {% if categoria_id == categoria.id %}selected{% endif %}>{{ categoria.nome }}</option>
        {% endfor %}
    </select>
    {% if current_user.is_authenticated %}
        <label style="margin-left: 20px;">
            <input type="checkbox" name="favoritos" value="1" onchange="this.form.submit()" {% if favoritos_only %}checked{% endif %}>
            Apenas Favoritos
        </label>
    {% endif %}
    <noscript><button type="submit">Filtrar</button></noscript>
    {% if categoria_id or favoritos_only %}
        <a href="{{ url_for('anuncio.explorar_anuncios') }}">Limpar filtro</a>
    {% endif %}
</form>
<table border="1">
    <tr>
        <th>Título</th>
        <th>Preço</th>
        <th>Categoria</th>
        <th>Ações</th>
    </tr>
    {% for anuncio in anuncios %}
    <tr>
        <td>{{ anuncio.titulo }}</td>
        <td>R$ {{ anuncio.preco }}</td>
        <td>{{ anuncio.categoria.nome }}</td>
        <td>
            <a href="{{ url_for('anuncio.publico_detail', id=anuncio.id) }}">Ver Detalhes</a>
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}
